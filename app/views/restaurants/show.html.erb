<% content_for(:html_title) { "店鋪詳細" } %>

<% @hash.each do |rest| %>
  <div class="row">
    <div class="col-xs-12">
      <h2><strong><%= rest[:name] %></strong></h2>
    </div>
  </div>
  <div class="row">
    <div class="col-xs-5">
      <%= image_tag rest[:image_url][:shop_image1] , class: 'img-responsive center-block' %>
    </div>
    <div class="col-xs-7">
      <h3>営業時間</h3>
      <h4><%= rest[:opentime] %></h4>
      <h3>営業日</h3>
      <h4><% rest[:holiday] %></h4>
      <h3>カテゴリ</h3>
      <h4><%= rest[:category] %></h4>
      <h3>紹介文</h3>
      <h4><%= rest[:pr][:pr_long] %></h4>
      <li><%= link_to 'お得なクーポンはこちら', rest[:coupon_url][:pc] %></li>
      <li><%= link_to 'ぐるなびの詳細ページへ', rest[:url] %></li>
    </div>
  </div>

  <h2>住所</h2>
  <h3><%= rest[:address] %></h3>
  <style>
    #target {
      width: 550px;
      height: 400px;
    }
  </style>
  <div id="target"></div>
  <ul id="info">
    <li><%= rest[:name] %></li>
    <li><%= rest[:address] %></li>
    <li><%= image_tag rest[:image_url][:shop_image1] , class: 'img-responsive center-block' %></li>
  </ul>

  <script
    src="https://maps.googleapis.com/maps/api/js?language=ja&region=JP&key=AIzaSyCUzGkhZi61kjs2Cyn59SMqtqZvgJbARKA&callback=initMap" async defer></script>
  <script>
    function initMap(){
      'use strict';

      var target = document.getElementById('target');
      var map;
      var shop = {lat: <%= rest[:latitude] %>, lng: <%= rest[:longitude] %>};
      var marker;
      var infoWindow;

      map = new google.maps.Map(target, {
        center: shop,
        zoom: 14,
        disableDefaultUI: true,
        zoomControl: true
      });
        marker = new google.maps.Marker({
        position: shop,
        map: map
      });
      infoWindow = new google.maps.InfoWindow({
        position: shop,
        content: document.getElementById('info')
      });

      infoWindow.open(map);

    }
  </script>

<% end %>


<h3>このお店を調べた人はこんな記事を見ています</h3>
<% if @moments %>
  <div class="row">
    <% @moments.first(1).each do |moment| %>
      <div class="col-xs-4">
        <%= moment.title %><br>
        <%= image_tag moment.urlToImage, :size => '300x200' %>
      </div>
      <div class="col-xs-8">
        <%= moment.description %>
        <%= link_to '記事詳細へ飛ぶ', moment.url %>
      </div>
    <% end %>
  </div>
<% else %>
  <h2>只今関連記事はございません。</h2>
<% end %>


